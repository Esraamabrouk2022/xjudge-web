<mat-dialog-content>
    <div class="dialog-container">
        <h2 class="dialog-title">Update Contest</h2>
        <form [formGroup]="updateContestForm">
            <div class="row" id="open-row" class="">
                <div class="mt-3  d-flex">
                    <label class="col-md-2 form-label mt-2 " for="submit-open">Type</label>
                    <div class="btn-group ms-3 " role="group">
                        <button type="radio" class="border btn btn btn-secondary"
                            [class.active]="updateContestForm.value.type === 'CLASSIC'" (click)="onClassicClick()"
                            [ngStyle]="{'background-color': updateContestForm.value.type === 'CLASSIC' ? '#0275d8' : 'white'}">
                            <img src="/assets/images/classical.gif" height="20" width="20">
                            <span [ngStyle]="{'color': updateContestForm.value.type === 'CLASSIC'? 'white' : 'black'}">
                                Classical Contest
                            </span>
                        </button>
                        <button type="radio" class="border btn btn-secondary "
                            [class.active]="updateContestForm.value.type === 'GROUP'" (click)="onGroupClick()"
                            [ngStyle]="{'background-color': updateContestForm.value.type === 'GROUP' ? '#0275d8' : 'white'}">
                            <img src="/assets/images/group.png" height="20" width="20">
                            <span [ngStyle]="{'color': updateContestForm.value.type === 'GROUP'? 'white' : 'black'}">
                                Group Contest
                            </span>
                        </button>
                    </div>
                </div>
            </div>

            <div class="mt-3 mb-3 d-flex">
                <label for="title" class="col-md-2 mt-2 me-3">Title</label>
                <input type="text" required id="contest-title" class="form-control" placeholder="Title"
                    formControlName="title" />
                <div *ngIf="updateContestForm.get('title')?.errors && updateContestForm.get('title')?.touched ">
                    <span *ngIf="updateContestForm.get('title')?.getError('required')" class="m-0"
                        style="color:red">Required</span>
                </div>
                <i></i>
            </div>

            <div class="mb-3 mt-3 d-flex">
                <label for="durationSeconds" class="col-md-2 mt-2 me-3">Duration</label>
                <input id="durationSeconds" class="form-control" formControlName="durationSeconds" type="number"
                    placeholder="duration in minutes" />
                <div
                    *ngIf="updateContestForm.get('durationSeconds')?.errors && updateContestForm.get('durationSeconds')?.touched ">
                    <span *ngIf="updateContestForm.get('durationSeconds')?.getError('required')" class="m-0"
                        style="color:red">Required</span>
                </div>
                <i></i>
            </div>

            <div *ngIf="isGroupSelected && !isGroupSelectorDisabled" class="mt-3 mb-3 d-flex">
                <label for="visibility" class="col-md-2 me-3 mt-4">Group</label>
                <select *ngIf="userGroups.length >= 1" id="form3" class="form-select mt-3" formControlName="groupId">
                    <option value="0" selected>Select Group</option>
                    <option *ngFor="let group of userGroups" value="{{group.id}}">{{group.name}}</option>
                </select>
                <span *ngIf="userGroups.length == 0">You are not managing any group.</span>
                <div *ngIf="updateContestForm.get('groupId')?.errors && updateContestForm.get('groupId')?.touched ">
                    <span *ngIf="updateContestForm.get('groupId')?.getError('required')" class="m-0"
                        style="color:red">Required</span>
                </div>
                <i></i>
            </div>

            <div class="mt-3 mb-3 d-flex">
                <label for="beginTime" class="col-md-2 me-3">Begin Time(UTC+2)</label>
                <input id="beginTime" class="form-control" formControlName="beginTime" type="text"
                    placeholder="2024-04-17 23:00:00" type="datetime-local" />
                <div *ngIf="updateContestForm.get('beginTime')?.errors && updateContestForm.get('beginTime')?.touched ">
                    <span *ngIf="updateContestForm.get('beginTime')?.getError('required')" class="m-0"
                        style="color:red">Required</span>
                </div>
                <i></i>
            </div>

            <div class="mt-3 mb-3 d-flex">
                <label for="visibility" class="col-md-2 me-3 mt-4">visibility</label>
                <button type="radio" class="border btn btn btn-secondary"
                    [class.active]="updateContestForm.value.visibility === 'PUBLIC'"
                    (click)="updateContestForm.controls['visibility'].setValue('PUBLIC')"
                    [ngStyle]="{'background-color': updateContestForm.value.visibility === 'PUBLIC' ? '#0275d8' : 'white'}">
                    <span [ngStyle]="{'color': updateContestForm.value.visibility === 'PUBLIC'? 'white' : 'black'}">
                        Public
                    </span>
                </button>
                <button type="radio" class="border btn btn btn-secondary"
                    [class.active]="updateContestForm.value.visibility === 'PRIVATE'"
                    (click)="updateContestForm.controls['visibility'].setValue('PRIVATE')"
                    [ngStyle]="{'background-color': updateContestForm.value.visibility === 'PRIVATE' ? '#0275d8' : 'white'}">
                    <span [ngStyle]="{'color': updateContestForm.value.visibility === 'PRIVATE'? 'white' : 'black'}">
                        Private
                    </span>
                </button>
                <div
                    *ngIf="updateContestForm.get('visibility')?.errors && updateContestForm.get('visibility')?.touched ">
                    <span *ngIf="updateContestForm.get('visibility')?.getError('required')" class="m-0"
                        style="color:red">Required</span>
                </div>
                <i></i>
            </div>

            <div class="mb-3 mt-3 d-flex">
                <label for="password" class="col-md-2 mt-2 me-3">Password</label>
                <input id="password" class="form-control" formControlName="password" type="password"
                    placeholder="Password" />
                <i></i>
            </div>

            <div class="mt-3 mb-3 d-flex">
                <label for="description" class="col-md-2 mt-3 me-3">Description</label>
                <textarea id="description" class="form-control" formControlName="description"
                    placeholder="Description" rows="4"></textarea>
                <div
                    *ngIf="updateContestForm.get('description')?.errors && updateContestForm.get('description')?.touched ">
                    <span *ngIf="updateContestForm.get('description')?.getError('required')" class="m-0"
                        style="color:red">Required</span>
                </div>
                <i></i>
            </div>

            <table formArrayName="problems" class="table table-striped table-borderless">
                <thead>
                    <tr>
                        <th class="text-right">Operations</th>
                        <th class="text-center">OJ</th>
                        <th class="text-center">ProbNum</th>
                        <th class="text-center">Wgt.</th>
                        <th class="text-center">Alias</th>
                        <th class="text-center">Letter</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let problem of getFormProblems(); let i = index" [formGroupName]="i"
                        [id]="'addTable' + i" class="cp_row real">
                        <td class="text-right">
                            <button class="btn btn-outline-danger" [disabled]="!enableDeleteProblem"
                                (click)="removeProblemForm(i)">
                                <i class="fa fa-remove"></i>
                            </button>
                        </td>
                        <td>
                            <select class="form-select" formControlName="ojType">
                                <option value="">oj</option>
                                <option *ngFor="let onlineJudge of onlineJudges" [value]="onlineJudge">{{onlineJudge}}</option>
                            </select>
                        </td>
                        <td><input class="form-control" formControlName="code"></td>
                        <td><input class="form-control text-center" type="number" formControlName="problemWeight"></td>
                        <td><input class="form-control" formControlName="problemAlias"></td>
                        <td class="text-center">{{getLetter(i)}}</td>
                    </tr>
                </tbody>
            </table>

            <div class="form-group">
                <button class="btn btn-secondary w-100" (click)="addNewProblemForm()">
                    <i class="fa fa-plus"></i> Add a problem
                </button>
            </div>
        </form>
    </div>
</mat-dialog-content>

<mat-dialog-actions class="dialog-actions">
    <div class="dialog-actions" style="display: flex; justify-content: flex-end; align-items: flex-end; width: 100%;">
        <button type="button" class="btn btn-outline-danger" mat-dialog-close>Cancel</button>
        <button type="submit" class="btn btn-primary" [disabled]="updateContestForm.invalid"
            (click)="handleUpdateContest()">
            <span *ngIf="isLoading"><i class="fa fa-spinner fa-spin"></i> Updating</span>
            <span *ngIf="!isLoading"> Update</span>
        </button>
    </div>
</mat-dialog-actions>